# データベースについて

## データベースとは何か？

###なぜみんな使うのか？
以下のメリットがあるから

#### プログラムとの独立性
データベースのデータ構造が変化しても、プログラムを変更する必要がない。ファイルの場合はデータ構造が変化するとプログラムを変更しないといけない。
DBでは、データの物理的な格納形態や検索手順の詳細に依存しない。

実装が隠されている？

#### 同時実行制御

#### データの一貫性（整合性）

#### データの検索効率が高い

#### データの機密性
クライアントができる操作を制限できる。

#### 障害回復


##関連用語
### トランザクション
（コンピュータ側の）複数の処理を一つの処理としてまとめて行うこと。
全てが成功しないとトランザクションは成功と判断されない。一つでも失敗するとトランザクションは失敗となり、他の成功していた処理も実行してなかったことになる。
例）切符の予約、銀行の入金・出金


### インデックス（索引）
インデックス（索引）とは、データベースで高速に検索をかけるための仕組みである。

#### B-Treeインデックス
木構造をしている。
例えばアルファベットの文字列を保存する場合、頭文字が(A-K)か(L-Z)かで二つのブロックに分ける。さらに(A-K)を、(A-D)、(E-G)、(H-K)の三つのブロックに分ける。(L-Z)についても、(L-O)、(R-P)、(S-Z)の三つに分けておく。
ここで、各頭文字(A-Z)の動物名がアルファベット順で一つずつ保存されているとし、20番めにTIGERという文字列が格納されていると仮定する。TIGERを頭から検索する場合は、20回目の判定で見つかる。インデックスを使用すれば(L-Z)->(S-Z)->S->Tと辿れるので、4回で済む。


## 正規化
正規化とはリレーショナルデータベースのテーブルを正規形にすること。データベースを正規化することで、データの重複をなくしたり、効率の良いアクセスを可能にしたり、整合性を確保できたりと、いろいろ良いことがある。

### リレーショナルデータベース
リレーショナルデータモデルに沿って設計されたデータベースのこと。

### 正規形

#### 第一正規形
データ（一行）内に繰り返される部分がない状態。
たとえば、[学生番号:1, 氏名:風流太朗, 学習教科:数学, 学習教科:英語]というデータはダメ。

[学生番号:1, 氏名:風流太朗, 学習教科:数学]

[学生番号:1, 氏名:風流太朗, 学習教科:英語]

というように二つのデータに分ければ第一正規形になる。

#### 第二正規形
同一行内でキー値を決定することで、他の列情報も一意に決定できる。
たとえば、学生のキー値が学生番号だとすると、

[学生番号:1, 氏名:風流太朗, 学習教科:数学]

[学生番号:1, 氏名:風流太朗, 学習教科:英語]

のままでは、キー値で行を一意に特定できない。
新たに「学習」テーブルを作成し、

[学生番号, 氏名] [学生番号, 学習教科]
						 
とすれば、学生テーブルでは学生番号で学生を一意に特定できる。

#### 第三正規形
キー以外の列においてそれぞれが従属関係を持った部分がない。非キー→非キーの関数従属性を排除する。

[学生番号, 氏名, 教科番号, 教科名, 成績]

[学生番号, 氏名] [学生番号, 教科番号, 成績] [教科番号, 教科名]


##### 注文票の例
[注文番号, 顧客ID, 顧客名, 顧客住所]

は、第三正規形ではない。
同じ顧客の注文が5件あったとすると、このテーブルに5行のデータが追加される。
もし、顧客の住所が変わった場合、この5件全てを修正する必要がある。

[注文番号, 顧客ID] [顧客ID, 顧客名, 顧客住所]

としておけば、一行修正するだけで済む。




